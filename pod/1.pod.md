
# Swift iOS ï¼š ä½¿ç”¨CocoaPodsç®¡ç†ä¾èµ–

å¼€å‘ä¸€ä¸ªå¯ç”¨çš„ç³»ç»Ÿï¼Œå†æ€ä¹ˆå°ä¹Ÿéœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚å¤§å®¶å¸¸å¸¸é‡‡ç”¨Alamofireè¿™ä¸ªç¬¬ä¸‰æ–¹åº“æ¥è®¿é—®ç½‘ç»œã€‚CocoaPodsæ˜¯ä¸€ç§éå¸¸ä¼˜ç§€çš„åŒ…å«ä¾èµ–å·¥ç¨‹åˆ°æœ¬å·¥ç¨‹å†…çš„æ–¹å¼ã€‚CocoaPodsä¸ºå¾ˆå¤šå¼€æºä»“åº“å»ºç«‹äº†ä¸€ç»„podspecæ–‡ä»¶åˆ—è¡¨ï¼Œæ­¤podspecæŒ‡å®šäº†åˆ°ä½•å¤„å»ä¸‹è½½ä»£ç ï¼Œä»¥åŠå¦‚ä½•å’Œå½“å‰å·¥ç¨‹é›†æˆã€‚

ä»¥æˆ‘è‡ªå·±ä¸ºä¾‹ï¼Œæˆ‘5æœˆä»½å¼€å§‹ç ”ç©¶Swiftï¼Œä¸ºå­¦ä¹ çš„ç›®çš„è€Œå¼€å‘äº†ä¸€ä¸ª[cnode](https://github.com/1000copy/cnode) å®¢æˆ·ç«¯ã€‚æœ€åˆä¸ºäº†è®©è‡ªå·±å¯ä»¥é›†ä¸­ç²¾åŠ›äºcnodeæœ¬èº«çš„ä¸šåŠ¡é€»è¾‘ï¼Œå› æ­¤å†³å®šä½¿ç”¨äº†ä¸€äº›ç¬¬ä¸‰æ–¹å¼€æºåº“ï¼š

    Alamofire
    ObjectMapper 
    AlamofireObjectMapper
    Cartography
    Kingfisher 
    GTMRefresh
    DrawerController
    SwiftIcons
    PKHUD

æœ‰äº†CocoaPodsï¼Œåªè¦ç¼–å†™ä¸€ä¸ªPodfileï¼Œå†™å…¥è¿™äº›æ–‡ä»¶å’Œç‰ˆæœ¬ï¼š

  use_frameworks!
  target 'cnode' do
      pod 'Alamofire', '~> 4.4.0'
      ...
  end

å°±å¯ä»¥ä½¿ç”¨podå‘½ä»¤ï¼Œä¸€é”®æ›´æ–°å…¨éƒ¨ä¾èµ–ã€‚æ²¡æœ‰å®ƒçš„è¯ï¼Œæˆ‘å¾—æŠŠè¿™äº›ç¬¬ä¸‰æ–¹å¼€æºåº“çš„æºä»£ç æ–‡ä»¶å¤åˆ¶åˆ°é¡¹ç›®ä¸­ï¼Œæˆ–è€…è®¾ç½®æˆgit submoduleã€‚é‚£äº›æ¼äººçš„å’Œä¾èµ–å…³ç³»ï¼Œè¿˜æœ‰ç¼–è¯‘å‚æ•°é…ç½®ä»€ä¹ˆçš„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Podè€Œå¾—ä»¥å…é™¤ã€‚

æœ¬æ–‡æ¢è®¨çš„æ˜¯å¦‚ä½•ä½¿ç”¨ä¸šå·²å­˜åœ¨å’Œä¹…ç»è€ƒéªŒçš„Swiftç¬¬ä¸‰æ–¹Podï¼Œä»¥åŠå¦‚ä½•åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„Podï¼Œå¹¶æŠŠå®ƒå‘å¸ƒåˆ°CocoaPodsä»“åº“å†…ã€‚

## ä½¿ç”¨Pod

### å‡†å¤‡CocoaPods

CocoaPodséœ€è¦ç³»ç»Ÿå†…å·²ç»å®‰è£…äº†rubyï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œè¯·é¦–å…ˆå®‰è£…å®ƒã€‚

å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

    sudo gem install cocoapods
    
å®‰è£…gemå·¥å…·ã€‚éšå³ä½¿ç”¨ï¼š

    pod setup --verbose

ä¹‹åï¼Œåªè¦podç›®å½•æ²¡æœ‰æ›´æ–°ï¼Œå°±å°½å¯èƒ½ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼ˆå¿«å¾—å¤šï¼‰ï¼š

    pod install --verbose --no-repo-update
    
åšé…ç½®ã€‚å‘½ä»¤æ‰§è¡Œå®Œæ¯•ï¼Œcocoapodså°±æ˜¯å¯ç”¨çš„äº†ã€‚

### åˆ›å»ºä¸€ä¸ªæ¼”ç¤ºå·¥ç¨‹

æ­¥éª¤å¦‚ä¸‹ï¼š

1. æ‰“å¼€xcode
2. ç‚¹å‡»â€œCreate a new Xcode projectâ€
3. é€‰æ‹©Single View App
4. å¡«å†™product nameä¸ºpoddemoï¼›å¡«å†™è¯­è¨€ä¸ºSwift
5. è®¾ç½®ç›®å½•

å®Œæˆåˆ›å»ºåï¼Œé€€å‡ºxcode

### åˆå§‹åŒ–

æ‰“å¼€Terminalï¼Œå¯¼èˆªåˆ°å·¥ç¨‹ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š

    pod init

æ­¤å‘½ä»¤ä¼šåœ¨ç›®å½•å†…åˆ›å»ºPodfileæ–‡ä»¶ã€‚æ¥ä¸‹æ¥ä½¿ç”¨xcodeæ‰“å¼€Podfileæ–‡ä»¶ï¼š

    open -a Podfile
    
åŠ å…¥alamofireæ–‡ä»¶çš„ä¾èµ–ï¼Œä¿®æ”¹åçš„Podfileä¸ºï¼š

    target 'poddemo' do
      # Comment the next line if you're not using Swift and don't want to use dynamic frameworks
      use_frameworks!
    
      # Pods for poddemo
      pod 'Alamofire', '~> 4.4'
    end


é€€å‡ºxcodeï¼Œåœ¨terminalå†…æ‰§è¡Œå‘½ä»¤ï¼š

    pod install
    
å®‰è£…Alamofireï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªæ‰©å±•åä¸ºxcworkspaceçš„æ–‡ä»¶ã€‚

## ä½¿ç”¨Alamofireè®¿é—®HTTP

å†æ¬¡ä½¿ç”¨xcoceæ‰“å¼€xcworkspaceæ–‡ä»¶ã€‚ç¼–è¾‘AppDelegate.swiftä¸ºï¼š

    import UIKit
    import Alamofire
    @UIApplicationMain
    class AppDelegate: UIResponder, UIApplicationDelegate {
        var window : UIWindow?
        func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
            foo()
            window = UIWindow()
            window!.rootViewController = UIViewController()
            window!.rootViewController!.view.backgroundColor = .blue
            window!.makeKeyAndVisible()
            return true
        }
        func foo(){
            Alamofire.request("https://httpbin.org/get").responseJSON { response in
                print(response.request)
                print(response.response)
                print(response.data)
                print(response.result)
                if let JSON = response.result.value {
                    print("JSON: \(JSON)")
                }
            }
        }
    }
    
ç¼–è¯‘è¿è¡Œï¼ŒæœŸæœ›çš„è¾“å‡ºä¸ºï¼š

    Optional(https://httpbin.org/get)
    Optional(<NSHTTPURLResponse: 0x600000222840> { URL: https://httpbin.org/get } { status code: 200, headers {
        "Access-Control-Allow-Credentials" = true;
        "Access-Control-Allow-Origin" = "*";
        Connection = "keep-alive";
        "Content-Length" = 359;
        "Content-Type" = "application/json";
        Date = "Wed, 26 Apr 2017 01:15:59 GMT";
        Server = "gunicorn/19.7.1";
        Via = "1.1 vegur";
    } })
    Optional(359 bytes)
    SUCCESS
    JSON: {
        args =     {
        };
        headers =     {
            Accept = "*/*";
            "Accept-Encoding" = "gzip;q=1.0, compress;q=0.5";
            "Accept-Language" = "en;q=1.0";
            Connection = close;
            Host = "httpbin.org";
            "User-Agent" = "poddemo/1.0 (home.poddemo; build:1; iOS 10.2.0) Alamofire/4.4.0";
        };
        origin = "221.237.156.243";
        url = "https://httpbin.org/get";
    }

å¦‚æœè¾“å‡ºæ˜¯å¯¹çš„ï¼Œå°±è¯´æ˜é€šè¿‡CocoaPodså¯¼å…¥çš„ç¬¬ä¸‰æ–¹åº“å·²ç»æˆåŠŸã€‚

## åˆ›å»ºPod

ä½ åˆ›å»ºäº†ä¸€ä¸ªåº“å‡½æ•°ï¼Œæƒ³è¦å…±äº«å®ƒã€‚æ€ä¹ˆåŠï¼Ÿcocoapodså¯ä»¥å¸®å¿™ã€‚
 
### å‡†å¤‡ä»£ç 
 
 é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºè¿™æ ·çš„Cocoa touch frameworkã€‚æ·»åŠ ä¸€ä¸ªswiftæ–‡ä»¶ï¼ˆåå­—ä¸ºï¼šrobot.swift)ï¼Œå†…å®¹ä¸ºï¼š

    import Foundation
    public func inc(_ i : Int)->Int{return i + 1}

ç¼–è¯‘é€šè¿‡å³å¯ã€‚

### ä¸ºæ­¤ä»£ç åˆ›å»ºpodspecæ–‡ä»¶

æƒ³è¦CocoaPodså¸®å¿™åˆ†äº«ï¼Œå°±å¾—æŒ‰ç…§å®ƒçš„è¦æ±‚ï¼Œç¼–å†™ä¸€ä¸ªè§„æ ¼æ–‡ä»¶ï¼Œä»¥ä¾¿è¯´æ˜ä½œè€…ï¼Œä¸»é¡µï¼Œæˆæƒç­‰ä¿¡æ¯ã€‚ç‰¹åˆ«é‡è¦çš„æ˜¯ï¼ŒæŒ‡æ˜æºä»£ç çš„ä½ç½®ã€‚

ç°åœ¨å¯¼èˆªåˆ°å·¥ç¨‹ç›®å½•ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š

    touch robot.podspec

ç²˜è´´å†…å®¹ä¸ºï¼š

  Pod::Spec.new do |s|
    s.name             = 'robot'
    s.version          = '0.1.0'
    s.summary          = 'ä¸€äº›å±è¯'
    s.description      = 'ä¸€äº›å±è¯'
    s.homepage         = 'https://github.com/1000copy/robot'
    s.license          = { :type => 'MIT', :file => 'LICENSE' }
    s.author           = { '1000copy' => '1000copy@gmail.com' }
    s.source           = { :path => '~/github/pod/robot' }
    s.ios.deployment_target = '10.0'
    s.source_files = 'robot/*'
  end

å…¶ä¸­ç‰¹åˆ«é‡è¦çš„æ˜¯s.name ,s.version , s.source ,s.source_files,æ²¡æœ‰è¿™äº›ä¿¡æ¯ï¼Œå‘å¸ƒpodæ˜¯ä¸å¯èƒ½çš„ã€‚

æœ€å¥½æ‰§è¡Œä¸‹è¿™ä¸ªå‘½ä»¤ï¼Œæ£€æŸ¥æ­¤podspecæ˜¯å¦æ­£ç¡®ï¼š

    pod lib lint

### å¼•ç”¨pod

åˆ›å»ºä¸€ä¸ªä½¿ç”¨podçš„Single View Appå·¥ç¨‹ï¼Œæ”¾åˆ°usepodå†…

  cd usepod
  pod init

ç²˜è´´å†…å®¹åˆ°Podfile

   pod 'robot',:path=> '~/github/pod/robot/robot.podspec'

æ‰§è¡Œå‘½ä»¤ï¼š

  pod install --verbose --no-repo-update

### å¼•ç”¨ä»£ç 

æ‰“å¼€usepod.workspaceæ–‡ä»¶ï¼Œè´´å…¥å¼•ç”¨ä»£ç åˆ°AppDelegate.swiftå†…ï¼š

    import UIKit
    import robot
    @UIApplicationMain
    class AppDelegate: UIResponder, UIApplicationDelegate {
        var window : UIWindow?
        func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
            print(inc(41))
            return true
        }
    }

### å‘å¸ƒåˆ°githubä»“åº“

æ–‡ä»¶æˆ‘ä»¬ä¼šæ”¾åˆ°githubä»“åº“ä¸Šï¼Œå› æ­¤ï¼Œä¸€ä¸ªgithubçš„è´¦å·æ˜¯å¿…è¦çš„ã€‚ä»“åº“éœ€è¦åˆ›å»ºä¸€ä¸ªreleaseï¼Œå› ä¸ºpodspecä¼šå¼•ç”¨æ­¤releaseã€‚æˆ‘çš„ç›¸å…³ä¿¡æ¯ï¼š

1. githubè´¦å·æ˜¯1000copy
2. ç”¨äºå­˜å‚¨åˆ†äº«ä»£ç çš„ä»“åº“åå­—ï¼šrobot

ä½ éœ€è¦åœ¨å¦‚ä¸‹çš„å‘½ä»¤å’Œæ“ä½œä¸­ï¼Œæ›¿ä»£ä¸ºä½ çš„å¯¹åº”ä¿¡æ¯ã€‚é¦–å…ˆï¼š

1. åˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œå‘½åä¸ºrobot
2. åœ¨å‘½ä»¤è¡Œå†…å¯¼èˆªåˆ°ä½ çš„å·¥ç¨‹ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ä»¥ä¾¿æŠŠä»£ç ä¼ é€’åˆ°githubä»“åº“å†…

    git init
    git add .
    git commit -m "init"
    git remote add origin <paste your URL here>
    git push -u origin master

3. åœ¨githubä¸Šï¼Œå¯¹æ­¤ä»“åº“åšä¸€ä¸ªreleaseï¼Œç‰ˆæœ¬å·è®¾ç½®ä¸º0.1.0ï¼Œè¿™ä¸ªå·ç å€¼ä¼šåœ¨podspecæ–‡ä»¶å†…å¼•ç”¨çš„ã€‚

### å‘å¸ƒåˆ°cocoapods

æ‰§è¡Œå‘½ä»¤å‘å¸ƒ,é¦–å…ˆæ³¨å†Œä½ çš„é‚®ä»¶ï¼Œç„¶åæ¨é€podspecã€‚

    pod trunk register 1000copy@gmail.com
    pod trunk push robot.podspec

æ³¨æ„ï¼Œæ³¨å†Œé‚®ä»¶åï¼Œcocoapodsä¼šå‘é€ä¸€ä¸ªé‚®ä»¶ç»™ä½ ï¼Œä½ ç‚¹å‡»é‡Œé¢çš„ç¡®è®¤é“¾æ¥ï¼Œå³å¯ç”Ÿæ•ˆã€‚

ä½ åº”è¯¥çœ‹åˆ°å¦‚ä¸‹çš„ä¿¡æ¯åé¦ˆï¼š

     ğŸ‰  Congrats
    
     ğŸš€  robot (0.1.0) successfully published
     ğŸ“…  August 16th, 06:03
     ğŸŒ  https://cocoapods.org/pods/robot
     ğŸ‘  Tell your friends!
     

ç°åœ¨ï¼Œä½ å¯ä»¥åƒå…¶ä»–podä¸€æ ·ä½¿ç”¨robotäº†ã€‚ 


## ä¸€äº›åŸç†

å½“ä½¿ç”¨pod setupå‘½ä»¤é…ç½®podæ—¶ï¼Œä½ ä¼šå‘ç°è¿™ä¸ªå‘½ä»¤æ‰§è¡Œçš„æ—¶é—´çœŸå¤Ÿä¹…çš„ï¼Œè¿™ä»¤æˆ‘æƒ³è¦è€ƒå¯Ÿå®ƒåˆ°åº•ä¸‹è½½äº†ä»€ä¹ˆä¸œè¥¿ã€‚

æˆ‘æ¢å¯»äº†æœ¬åœ°çš„å­˜å‚¨ï¼Œå‘ç°äº†ä¸€äº›cocoapodçš„å†…éƒ¨ç»„ç»‡å±‚é¢çš„ä¸œè¥¿ã€‚

å®é™…ä¸Šï¼ŒCocoaPodsæŠŠæ•´ä¸ªçš„Podä»“åº“éƒ½æ‹‰äº†ä¸‹æ¥ï¼Œæ•´ä¸ªå·¨å‹ä»“åº“åœ¨~/.cocoapodså†…å­˜æ”¾ã€‚æˆ‘è¿™é‡Œçš„å¤§å°æ˜¯ï¼š

    $ du -sh ~/.cocoapods
    1.5G  /Users/lcj/.cocoapods

æ¯ä¸€ä¸ªå¼€æºåº“éƒ½æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½æœ‰ä¸€ä¸ªç›®å½•ã€‚ç›®å½•å­˜æ”¾åœ¨æ­¤ï¼š

    /Users/lcj/.cocoapods/repos/master/Specs/d/a/2/Alamofire

å…±æœ‰è¿™å¤šä¹ˆçš„ç‰ˆæœ¬ï¼š

    $ls /Users/lcj/.cocoapods/repos/master/Specs/d/a/2/Alamofire
    1.1.3   2.0.0   3.0.0-beta.2  3.2.0   4.0.0
    1.1.4   2.0.0-beta.1  3.0.0-beta.3  3.2.1   4.0.1
    1.1.5   2.0.0-beta.2  3.0.1   3.3.0   4.1.0
    1.2.0   2.0.0-beta.3  3.1.0   3.3.1   4.2.0
    1.2.1   2.0.0-beta.4  3.1.1   3.4.0   4.3.0
    1.2.2   2.0.1   3.1.2   3.4.1   4.4.0
    1.2.3   2.0.2   3.1.3   3.4.2   4.5.0
    1.3.0   3.0.0   3.1.4   3.5.0   4.5.1
    1.3.1   3.0.0-beta.1  3.1.5   3.5.1

å…¶ä¸­çš„Alamofireç‰ˆæœ¬1.1.3çš„podspecæ–‡ä»¶æ˜¯è¿™ä¸ªï¼š
  
   $ls /Users/lcj/.cocoapods/repos/master/Specs/d/a/2/Alamofire/1.1.3/Alamofire.podspec.json 

å†…å®¹å¦‚ä¸‹ï¼š

    $ cat /Users/lcj/.cocoapods/repos/master/Specs/d/a/2/Alamofire/1.1.3/Alamofire.podspec.json 
    {
      "name": "Alamofire",
      "version": "1.1.3",
      "license": "MIT",
      "summary": "Elegant HTTP Networking in Swift",
      "homepage": "https://github.com/Alamofire/Alamofire",
      "social_media_url": "http://twitter.com/mattt",
      "authors": {
        "Mattt Thompson": "m@mattt.me"
      },
      "source": {
        "git": "https://github.com/Alamofire/Alamofire.git",
        "tag": "1.1.3"
      },
      "platforms": {
        "ios": "8.0"
      },
      "source_files": "Source/*.swift",
      "requires_arc": true
    }

ä»¥ä¸Šåˆ†æï¼Œå°±å¯ä»¥å¾—åˆ°æ¯æ¬¡CocoaPodsæ‰§è¡Œinstallæ“ä½œçš„è¿‡ç¨‹ã€‚å°±æ˜¯é¦–å…ˆåœ¨æœ¬åœ°çŸ¥é“å¯¹åº”çš„äº§å“å’Œç‰ˆæœ¬çš„ç›®å½•ï¼Œæ‰¾åˆ°podspecæ–‡ä»¶ï¼Œå’Œæ­¤æ–‡ä»¶å†…soureå±æ€§æŒ‡å®šçš„æ–‡ä»¶æºæ¯”å¯¹ï¼Œå¦‚æœå‘ç°æœ‰ä¿®æ”¹ï¼Œå°±ä¼šæ›´æ–°æœ€æ–°çš„ä»“åº“åˆ°æœ¬åœ°ã€‚

è‡³äºæŠŠæ•´ä¸ªä»“åº“ä¿å­˜åˆ°å®¢æˆ·ç«¯æ˜¯å¦åˆé€‚ï¼Œæˆ‘æŒæœ‰ä¿ç•™æ„è§ã€‚


å‚è€ƒï¼š

1. http://blog.devtang.com/2014/05/25/use-cocoapod-to-manage-ios-lib-dependency/
2. http://ishalou.com/blog/2012/10/16/how-to-create-a-cocoapods-spec-file/
3. http://www.yudiz.com/creating-your-own-ios-framework-and-distributed-using-cocoapods/
4. https://stackoverflow.com/questions/16020216/working-with-git-submodules-cocoapods